$(document).ready(function(){var a=250,b=50,c=150,d=400,e=a+b+c,f=15,g=0,h=20,i=8,j=function(j){$("#chart").remove(),$("#chart-wrapper .content").append('<div id="chart"></div>'),d=$("#chart").outerWidth();var k=Raphael("chart",d,e),l=0;$.each(j,function(a,b){l<b.value&&(l=b.value)});for(var m=[],n=0;i>=n;n++){var o=b+a-n*a/(i-1),p=l/(i-1)*n,q=k.path("m0, "+o+" L"+d+", "+o),r=0==n?"":"- ";q.attr({"stroke-dasharray":r,stroke:"#555"});var s=k.text(10,o,Math.ceil(p));s.attr({fill:"#555",title:p,"font-size":"12px","text-anchor":"end"}),m.push({line:q,label:s}),g<s.getBBox().width&&(g=s.getBBox().width,f=g+15)}$.each(m,function(a,b){b.line.translate(f,0),b.label.translate(g,0)}),$.each(j,function(b,g){var i=Object.size(j),m=g.value*a/l,n=(d-f-h-i*h)/i,o=f+h+b*(n+h),p=e-c-m,q=k.rect(o,p,n,m);q.attr({fill:g.color,title:g.value});var r=k.text(o+n/2,e-c-m-10,g.value);r.attr("fill","#555"),r.attr("font-size","12px");var r=k.text(o+n/2,e-c+15,g.label);r.attr({fill:"#555",title:g.label,"font-size":"12px","text-anchor":"start"}),r.rotate(45,o+n/2,e-c+15)})},k=store.get("data");void 0!=k&&(data=k),$("#data").val(JSON.stringify(data,null,4)),j(data.data),$(document).on("click","#run",function(a){var b=$("#data").val();void 0!=b&&""!=b&&(b=JSON.parse(b.replace(/\r?\n/g,"")),j(b.data),store.set("data",b))}),$(document).on("click","#clear",function(a){$("#data").val(""),$("#chart").remove()}),$(window).resize(function(a){var b=$("#data").val();d=$("#chart").width(),void 0!=b&&""!=b&&(b=JSON.parse(b.replace(/\r?\n/g,"")),j(b.data))})});