var addBookmarkDOM=function(a,b,c,d){var e=$bookmarkEntryTemplate.clone();e.data("id",a),e.find(".name").val(b),e.find(".name").attr("title",b),e.find(".url").val(c),e.find(".url").attr("title",c),e.find(".open-bookmark").attr("href",c),e.appendTo("#bookmarks-list .page[data-id="+d+"]")},displayBookmarks=function(a,b){var c=b.length,d=Math.ceil(c/ENTRIES_BY_PAGE),e=$(".pageLink.active").data("id");$("#bookmarks-list").empty(),$("#paginationList").empty();for(var f=0;d>f;f++)addPage(f);0==d&&addPage(0);var f=0,g=0,h=b.slice(0);$.each(h.reverse(),function(a,b){f%ENTRIES_BY_PAGE==0&&0!=f&&g++,addBookmarkDOM(b.id,b.name,b.url,g),f++}),a?($(".pageLink").last().data("id")<e&&(e=$(".pageLink").last().data("id")),showPage(e)):showPage(0)},getBookmarks=function(a){$.get(AJAX_GET_PATH,function(b){bookmarkArray=JSON.parse(b),displayBookmarks(a,bookmarkArray)})},isInt=function(a){return!isNaN(a)&&function(a){return(0|a)===a}(parseFloat(a))},addBookmarkDB=function(a,b){console.log(a,b),$.post(AJAX_POST_PATH,{ajaxType:1,name:a,url:b}).done(function(c){isInt(c)?(console.log("Bookmark added successfully"),bookmarkArray={id:c,name:a,url:b},console.log(bookmarkArray),getBookmarks()):alert("Error : "+c)})};$(document).on("click","#add-bookmark",function(a){var b=$(this).parents("#add-bookmark-wrapper"),c=b.find(".name").val(),d=b.find(".url").val(),e=b.find(".error");validateURL(d)?(e.hide(),addBookmarkDB(c,d)):(e.text("Please enter a valid URL (http://www.example.com)"),e.show(),b.find(".url").focus())});var deleteBookmark=function(a,b){$.post(AJAX_POST_PATH,{ajaxType:2,id:a}).done(function(a){1==a?(console.log("Bookmark deleted successfully"),console.log(a),getBookmarks(!0)):alert("Error : "+a)})};$(document).on("click",".bookmark-entry .delete-bookmark",function(a){var b=$(this).parents(".bookmark-entry"),c=b.data("id");deleteBookmark(c,b)});var editBookmark=function(a,b,c,d){$.post(AJAX_POST_PATH,{ajaxType:3,id:a,name:b,url:c}).done(function(a){1==a?(console.log("Bookmark edited successfully"),console.log(a),d.find("input").attr("disabled",!0),d.find("input").removeClass("edit"),d.find(".save-bookmark").hide(),d.find(".edit-bookmark").show()):alert("Error : "+a)})};$(document).on("click",".bookmark-entry .edit-bookmark",function(a){var b=$(this).parents(".bookmark-entry");b.find("input").removeAttr("disabled"),b.find("input").addClass("edit"),b.find(".name").focus(),$(this).hide(),b.find(".save-bookmark").show()}),$(document).on("click",".bookmark-entry .save-bookmark",function(a){var b=$(this).parents(".bookmark-entry"),c=b.data("id"),d=b.find(".name").val(),e=b.find(".url").val(),f=b.find(".error");validateURL(e)?(f.hide(),editBookmark(c,d,e,b)):(f.text("Please enter a valid URL (http://www.example.com)"),f.show(),b.find(".url").focus())}),$(document).ready(function(){getBookmarks()});